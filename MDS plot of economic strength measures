dt <- read_csv("https://raw.githubusercontent.com/gunhojung/315_final_project/master/countries.csv")

country_cont <- dplyr::select(dt, c("GDP ($ per capita)", "Literacy (%)", "Phones (per 1000)", 
                                    "Infant mortality (per 1000 births)", "Country"))
country_cont <- na.omit(country_cont)

country_cont_scale <- scale(country_cont[1:4])
dist_country <- dist(country_cont_scale)
country_mds <- cmdscale(dist_country, k = 2)
colnames(country_mds) <- c("mds_coordinate_1", "mds_coordinate_2")

country_mds <- cbind(country_mds, country_cont["Country"])
dt <- left_join(dt, country_mds, by = "Country")

choices = dt["Country"]

# MDS plot of countries 
shinyApp(
  
  ui = fluidPage(
    titlePanel("MDS of economic strength measures on countries, colored by region"),
    
    sidebarLayout(
      sidebarPanel(
        inputPanel(
          selectInput("country", 
                      label = "Select a country", 
                      choices, 
                      selected = "United States",
                      multiple = TRUE)
        )
      ),
      mainPanel(
        plotOutput("country_MDS")
      )
    )
  ),
  
  server = function(input, output, session) {
    
    output$country_MDS <- renderPlot({
      ggplot(subset(dt, Country %in% input$country), 
             aes(x = mds_coordinate_1, y = mds_coordinate_2, color = Region)) +
        geom_text(aes(label = subset(dt, Country %in% input$country)$Country)) +
        labs(x = "MDS coordinate 1",
             y = "MDS coordinate 2")
    })
  }
)
